<!DOCTYPE html>
<html lang="en">
  <head>
    <title>red</title>
	<style type="text/css">
	</style>
  </head>
  <body>
	  <a href="javascript:void(0)" id="edit">edit</a>

	  <div>
			<%- red_include(red_inc.main) %>

			<script type="text/javascript">
				$(function() {
					$("a#edit").on("click", function() {
						var editorWindow = window.open("../src/view/editor.ejs.html", "red_editor", "toolbar=yes, location=yes, directories=yes, status=yes, menubar=yes, scrollbars=yes, resizable=yes, width=800, height=600"); 
						window.addEventListener("message", function(event) {
							if(event.source === editorWindow) {
								if(event.data === "ready") {
									$("a#edit").text("editing");
									editorWindow.addEventListener("unload", function() {
										$("a#edit").text("edit");
									});
									window.addEventListener("unload", function() {
										editorWindow.close();
									});
									window.post = function(str) {
										editorWindow.postMessage(str, window.location.origin);
									};
								} else {
									console.log(event.data);
								}
							}
						});
					});
				});
			</script>
	  </div>
  </body>
</html>
