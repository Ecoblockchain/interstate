<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Interstate Runtime: Same Window</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  </head>
  <body>
		<div class="output"></div>
		<!--<canvas id="canvas" width="600" height="100"></canvas>-->
		<div id="editor"></div>
	  <div>
			<%- ist_include(ist_inc.vendor) %>
			<%- ist_include(ist_inc.runtime) %>
			<%- ist_include(ist_inc.editor) %>
			<%- ist_include(ist_inc.runtime_style) %>
			<script type="text/javascript">
				//var root = interstate.get_default_root();
				$("div#editor").editor({
					debug_env: true,
					server_window: window
				});
				$("div.output").dom_output({
					open_separate_client_window: false,
					edit_on_open: true,
					show_edit_button: false,
					//root: root
				});
				function getRoot() {
					return $("div.output").dom_output("option", "root");
				}
				function getEnvironment() {
					return new interstate.Environment({root: getRoot()});
				}
				/*
				window.env = getEnvironment();
				console.log("Begin setting objects");
				env.set("a", "<stateful>")
					.cd("a")
					.set("(prototypes)", "(start)", "[svg.rect, physics.fixture]")
				env .top()
				/*
				env.print();
				env.set("b", "<stateful>")

				env.cd("super_obj");

				var super_obj = env.get_pointer_obj;
				var cobj = interstate.find_or_put_contextual_obj(super_obj, env.pointer);

				interstate.cjs.liven(function() {
					console.log(cobj.children());
				});
			

				//env.print_on_return = true;
				env.set("(copies)", "1")
					.set("(copies)", "")
				*/
			</script>
	  </div>
  </body>
</html>
