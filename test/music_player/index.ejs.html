<!DOCTYPE html>
<html lang="en">
	<head>
		<title>music player</title>
		<script type="text/javascript" src="../../server/jquery-1.7.2.min.js"></script>
		<script type="text/javascript" src="data.js"></script>
	</head>
	<body>
		<div class="output"></div>

		<div>
			<%- red_include(red_inc.main) %>

			<script type="text/javascript">
				var cjs = red.cjs, _ = cjs._;
				$(function() {
					var env = red.create_environment($(".output")[0]);
					/*
					env.in_prop("children");
					env.set("a", "stateful");
					env.set("b", "stateful");
					//var c = env.set("c", "stateful");

					env.top();
					env.in_prop("children.a");
					env.set("tag", "'div'");
					window.a = env.get_context();

					env.set("blueprints");
					env.set_cell("blueprints", "INIT", "[dom]");

					env.top();

					env.in_prop("children.b");
					window.b = env.get_context();

					env.set("blueprints");
					env.set_cell("blueprints", "INIT", "[a]");
					/*
					env.add_state("s1");
					env.add_state("s2");
					env.top();

					env.in_prop("children.c");
					window.c = env.get_context();

					env.set("blueprints");
					env.set_cell("blueprints", "INIT", "[b]");
					env.top();
					*/

					env.set("clickable_button", "stateful");
					env.in_prop("clickable_button");
					env.rename_state("INIT", "idle");
					env.add_state("hover");
					env.add_state("active");
					env.add_state("activeout");
					env.add_transition("idle", "hover", "mouseover(this)");
					env.add_transition("hover", "idle", "mouseout(this)");
					env.add_transition("hover", "active", "mousedown(this)");
					env.add_transition("active", "activeout", "mouseout(this)");
					env.add_transition("active", "hover", "mouseup(window)");
					env.add_transition("activeout", "active", "mouseover(this)");
					env.add_transition("activeout", "idle", "mouseup(window)");
					env.set("blueprints");
					env.set("tag");
					env.set("src");
					env.set_cell("blueprints", "idle", "[dom]");
					env.set_cell("tag", "idle", "'img'");

					env.top();
					env.in_prop("children");

					env.set("prev_button", "stateful");
					env.in_prop("prev_button");
					env.set("blueprints");
					env.set("src");
					env.set_cell("blueprints", "INIT", "[clickable_button]");
					env.set_cell("src", "idle", "'buttons/play.png'");
					env.set_cell("src", "hover", "'buttons/play.png'");
					env.set_cell("src", "active", "'buttons/play_active.png'");
					env.set_cell("src", "activeout", "'buttons/play.png'");

					window.prev = env.get_context();
					window.src = prev.get_prop("src");

					/*

					env.in_prop("children");
					env.set("header", "stateful");
					env.in_prop("header");
					env.set("blueprints");
					/*
					env.set_cell("blueprints", 5, "[dom]");
					var item_view = cjs.create("red_dict");



					var songs = cjs(function() {
						
					});
					console.log(albums);
					*/

					window.env = env;
					//_.defer(function() {console.log(env.print())});
					console.log(env.print());
				});
			</script>
		</div>
	</body>
</html>
