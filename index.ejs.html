<!DOCTYPE html>
<html lang="en">
  <head>
    <title>red</title>
  </head>
  <body>
		<div class="content">
		</div>
	  <div>
			<%- red_include(red_inc.main) %>
			<script type="text/javascript">
				var env = red.create("environment");

				/*
				env	.cd("children")
					.set("obj", "stateful")
					.cd("obj")
					.rename_state("INIT", "flash1")
					.add_state("flash2")
					.add_transition("flash1", "flash2", "on('timeout', interval)")
					.add_transition("flash2", "flash1", "on('timeout', interval)")
					.set("(protos)", "flash1", "dom")
					.set("tag")
					.set("text")
					.set("backgroundColor")
					.set("tag", "flash1", "'div'")
					.set("text", "flash1", "'hello'")
					.set("backgroundColor", "flash1", "'red'")
					.set("backgroundColor", "flash2", "'green'")
					.top()
					.set("interval", "500")
					;
				*/
				env.cd("children")
					.set("obj", "stateful")
					.cd("obj")
					.add_state("state2")
					.add_transition("INIT", "state2", "on('timeout', 1000)")
					.set("tag")
					.set("text")
					.set("(protos)", "INIT", "dom")
					.set("tag", "INIT", "'div'")
					.set("text", "INIT", "i")
					.set("i");

				var scobj = env.get_current_statechart();
				var start = scobj.get_start_state();
				var outgoing = start.get_outgoing_transitions()[0];
				env.set("i", "INIT", 1)

				env //.set("i", "INIT", "10")
					.set("i", env._last_transition, "i+1")
					;
				//env.print_on_return = true;
				//console.log(env.print());

				var root_pointer = env.get_root_pointer();
				output_view = $("<div />").dom_output({
					root: root_pointer
				}).appendTo(document.body);
			</script>
	  </div>
  </body>
</html>
