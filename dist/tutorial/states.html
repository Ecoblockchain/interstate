<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Euclase Tutorial: States</title>
		<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="main.css"></link>
	</head>
	<body>
		<h1>States</h1>
		<p>Every object also has a built-in <em>state machine</em>, shown above the object. A state machine specifies <em>states</em> and <em>transitions</em> between states. Every object property may specify a cell for every state in the object. The <em>active</em> value for any property is indicated with <span style="border: 2px solid red">a red outline</span>.</p>
		<p>States can be added by pressing the <code>+</code> button to the right of the state machine. Transitions can be added by pressing the mouse down over the transition's <em>from</em> state and releasing it over its <em>to</em> state.</p>
		<p>Like properties and cells, both states and transitions can be edited by clicking on them and removed by deleting their text.</p>
		<p class="request">try playing with the states and transitions below:</p>
		<div id="hovertest" style="width: 200px; height: 100px; margin-bottom:25px; background-color: #900; color: white; margin: auto; font-size: 1.5em;">Hover over me &amp; watch <code>OBJ.foo</code> below</div>
		<div data-euc="edit one_state"></div>
		<h2>Events</h2>
		<p>You may have noticed that the above example includes a built-in property of <var>root</var> named <var>on</var>. <var>on</var>'s value is <code>(native function)</code>, which means that it's a builtin Euclase JavaScript function. <var>on</var> allows users to specify transition events.</p>
		<p>Euclase also includes a number of built-in events. You can try some of them below. These include <a href="http://en.wikipedia.org/wiki/DOM_events" target="_blank">DOM events</a>, specified by <code>on('<span style="opacity:0.5">&lt;event_type&gt;</span>', <span style="opacity: 0.5">&lt;target&gt;</span>)</code>. For example, <code>on('mousedown', elem)</code> or <code>on('keydown', window</code>)</p>

		<div id="target" style="width: 200px; height: 80px; margin-bottom:25px; background-color: #900; color: white; margin: auto; font-size: 1.5em;text-align:center;padding-top:30px;"><code>elem</code></div>
		<div data-euc="edit custom_events"></div>
		<footer>
			<a class="prev" href="cells.html">Cells</a>
			<a class="next" href="inheritance.html">Inheritance</a>
		</footer>
	</body>
	<link rel="stylesheet" href="../style/editor_style.css" />
	<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
	<script src="../_vendor/esprima.js"></script>
	<script src="../red.js"></script>
	<script src="tutorial_example_loader.js"></script>
	<script type="text/javascript">
		euc_examples.one_state = function() {
			var env = red.create("environment", {create_builtins: true});
			env	.set("OBJ", red.create("stateful_obj", {has_protos: false}))
				.cd("OBJ")
					.add_state("idle")
					.add_state("hover")
					.start_at("idle")
					.add_transition("idle", "hover", "on('mouseover', elem)")
					.add_transition("hover", "idle", "on('mouseout', elem)")
					.set("foo", "idle", "1")
					.set("foo", "hover", "2")
					.set("bar", "idle", "5")
					.set("baz", "hover", "10")
					.up()
					.set("elem", document.getElementById("hovertest"))
				.unset("find")
				.unset("emit")
				.unset("dom")
				.unset("child_nodes");
			return env.get_root();
		};
		euc_examples.custom_events = function() {
			var env = red.create("environment", {create_builtins: true});
			env	.set("OBJ", red.create("stateful_obj", {has_protos: false}))
				.cd("OBJ")
					.add_state("idle")
					.add_state("hover")
					.start_at("idle")
					.add_transition("idle", "hover", "on('mouseover', elem)")
					.add_transition("hover", "idle", "on('mouseout', elem)")
					.set("foo", "idle", "1")
					.set("foo", "hover", "2")
					.set("bar", "idle", "5")
					.set("baz", "hover", "10")
					.up()
					.set("elem", document.getElementById("target"))
				.unset("find")
				.unset("emit")
				.unset("dom")
				.unset("child_nodes");
			return env.get_root();
		};
	</script>
</html>
